const n=(n,e="text")=>{if(null==n)return"";switch(e){case"number":return"number"==typeof n?n.toLocaleString("pt-BR"):String(n);case"currency":return"number"==typeof n?n.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}):String(n);case"date":return n instanceof Date?n.toLocaleDateString("pt-BR"):"string"==typeof n?new Date(n).toLocaleDateString("pt-BR"):String(n);case"percent":return"number"==typeof n?`${n.toFixed(2)}%`:String(n);default:return String(n)}},e=e=>{const{filename:t,columns:o,data:r}=e,a="\ufeff"+[o.map(n=>`"${n.header}"`).join(";"),...r.map(e=>o.map(t=>{const o=e[t.key];return`"${n(o,t.format).replace(/"/g,'""')}"`}).join(";"))].join("\r\n"),s=new Blob([a],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(s),c=document.createElement("a");c.href=l,c.download=`${t}.csv`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)},t=e=>{const{filename:t,title:o,columns:r,data:a,author:s="NeoPower Dashboard"}=e,l=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<?mso-application progid="Excel.Sheet"?>\n<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">\n  <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\n    <Author>${s}</Author>\n    <Created>${(new Date).toISOString()}</Created>\n  </DocumentProperties>\n  <Styles>\n    <Style ss:ID="Header">\n      <Font ss:Bold="1" ss:Size="12"/>\n      <Interior ss:Color="#4A5568" ss:Pattern="Solid"/>\n      <Font ss:Color="#FFFFFF"/>\n      <Alignment ss:Horizontal="Center"/>\n    </Style>\n    <Style ss:ID="Title">\n      <Font ss:Bold="1" ss:Size="14"/>\n      <Alignment ss:Horizontal="Center"/>\n    </Style>\n    <Style ss:ID="Currency">\n      <NumberFormat ss:Format="R$ #,##0.00"/>\n    </Style>\n    <Style ss:ID="Percent">\n      <NumberFormat ss:Format="0.00%"/>\n    </Style>\n    <Style ss:ID="Date">\n      <NumberFormat ss:Format="dd/mm/yyyy"/>\n    </Style>\n  </Styles>\n  <Worksheet ss:Name="Dados">\n    <Table>`,c=r.map(n=>`<Column ss:Width="${n.width||100}"/>`).join("\n"),i=o?`<Row>\n        <Cell ss:StyleID="Title" ss:MergeAcross="${r.length-1}">\n          <Data ss:Type="String">${o}</Data>\n        </Cell>\n      </Row>\n      <Row></Row>`:"",d=`<Row>\n    ${r.map(n=>`<Cell ss:StyleID="Header"><Data ss:Type="String">${n.header}</Data></Cell>`).join("\n")}\n  </Row>`,m=a.map(e=>`<Row>${r.map(t=>{const o=e[t.key];let r="String",a="",s=n(o,t.format);return"number"===t.format||"currency"===t.format||"percent"===t.format?(r="Number",s="number"==typeof o?String(o):"0","currency"===t.format&&(a=' ss:StyleID="Currency"'),"percent"===t.format&&(a=' ss:StyleID="Percent"')):"date"===t.format&&(a=' ss:StyleID="Date"'),`<Cell${a}><Data ss:Type="${r}">${s}</Data></Cell>`}).join("\n")}</Row>`).join("\n"),p=new Blob([l+c+i+d+m+"\n    </Table>\n  </Worksheet>\n</Workbook>"],{type:"application/vnd.ms-excel;charset=utf-8"}),f=URL.createObjectURL(p),u=document.createElement("a");u.href=f,u.download=`${t}.xls`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(f)},o=e=>{const{filename:t,title:o,columns:r,data:a,author:s="NeoPower Dashboard"}=e,l=`\n<!DOCTYPE html>\n<html lang="pt-BR">\n<head>\n  <meta charset="UTF-8">\n  <title>${t}</title>\n  <style>\n    @page {\n      size: landscape;\n      margin: 1cm;\n    }\n    body {\n      font-family: Arial, sans-serif;\n      font-size: 12px;\n      line-height: 1.4;\n      color: #333;\n    }\n    .header {\n      text-align: center;\n      margin-bottom: 20px;\n    }\n    .header h1 {\n      font-size: 18px;\n      margin: 0;\n      color: #1a365d;\n    }\n    .header p {\n      font-size: 10px;\n      color: #666;\n      margin: 5px 0;\n    }\n    table {\n      width: 100%;\n      border-collapse: collapse;\n      margin-top: 10px;\n    }\n    th {\n      background-color: #2d3748;\n      color: white;\n      padding: 8px;\n      text-align: left;\n      font-weight: bold;\n      font-size: 11px;\n      border: 1px solid #1a202c;\n    }\n    td {\n      padding: 6px 8px;\n      border: 1px solid #e2e8f0;\n      font-size: 10px;\n    }\n    tr:nth-child(even) {\n      background-color: #f7fafc;\n    }\n    tr:hover {\n      background-color: #edf2f7;\n    }\n    .footer {\n      margin-top: 20px;\n      text-align: center;\n      font-size: 9px;\n      color: #666;\n    }\n    .currency { text-align: right; }\n    .number { text-align: right; }\n    .percent { text-align: right; }\n    @media print {\n      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }\n    }\n  </style>\n</head>\n<body>\n  <div class="header">\n    <h1>${o||t}</h1>\n    <p>Gerado em: ${(new Date).toLocaleString("pt-BR")} | Por: ${s}</p>\n  </div>\n  <table>\n    <thead>\n      <tr>\n        ${r.map(n=>`<th>${n.header}</th>`).join("")}\n      </tr>\n    </thead>\n    <tbody>\n      ${a.map(e=>`\n        <tr>\n          ${r.map(t=>{const o=e[t.key],r=n(o,t.format);return`<td class="${"currency"===t.format||"number"===t.format||"percent"===t.format?t.format:""}">${r}</td>`}).join("")}\n        </tr>\n      `).join("")}\n    </tbody>\n  </table>\n  <div class="footer">\n    <p>Total de registros: ${a.length} | NeoPower Dashboard</p>\n  </div>\n  <script>\n    window.onload = function() {\n      window.print();\n      setTimeout(function() { window.close(); }, 500);\n    };\n  <\/script>\n</body>\n</html>`,c=window.open("","_blank");c&&(c.document.write(l),c.document.close())},r=(n,r)=>{switch(n){case"csv":e(r);break;case"excel":t(r);break;case"pdf":o(r)}};export{t as a,e as b,r as c,o as e};
