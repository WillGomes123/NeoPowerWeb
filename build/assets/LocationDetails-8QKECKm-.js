const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/charts-BaPK5s1M.js","assets/react-vendor-BVAhLato.js"])))=>i.map(i=>d[i]);
import{j as e}from"./ui-vendor-D6QdPKSZ.js";import{a,l as s,h as r}from"./react-vendor-BVAhLato.js";import{c as t,C as l,a as d,b as i,B as c,d as n,M as m,g as o,f as x,t as h,I as p,R as j,Z as u,D as g,j as b,_ as f,k as N,U as v,l as y}from"./index-CZbXzKBK.js";import{S as w}from"./square-pen-B2T0eStT.js";import{F as k,D as C}from"./file-text-WjkpG4JL.js";import{U as _,S as E}from"./user-BTdvKJf8.js";import{P as z}from"./phone-Qi-F-Vk9.js";import{S}from"./search-zU9JOE0m.js";import{A as $}from"./activity-RP9HCYsq.js";import{C as I}from"./chevron-left-UOAoBCoy.js";import{C as R}from"./chevron-right-BEibx5W9.js";import{e as D,a as T,b as L}from"./export-B3G8m_WB.js";import{T as P}from"./trending-up-CelCpCNl.js";import{W as A,a as F}from"./wifi-BGmL9QME.js";import{C as O}from"./circle-x-erO3nCEQ.js";import{C as V,a as M}from"./circle-check-big-BTx50d3n.js";import{P as W,I as U}from"./power-DldYq7cP.js";import{X as B}from"./x-jGKBHEEN.js";import{A as K}from"./arrow-left-C3ElynVd.js";import"./charts-BaPK5s1M.js";
/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=t("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),G=t("mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),H=t("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Q=t("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),X=t("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Y=["segunda","terca","quarta","quinta","sexta","sabado","domingo"],Z={segunda:"Segunda-feira",terca:"Terça-feira",quarta:"Quarta-feira",quinta:"Quinta-feira",sexta:"Sexta-feira",sabado:"Sábado",domingo:"Domingo"};function J({location:s,onUpdate:r}){const[t,x]=a.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between border-b border-emerald-800/30 pb-4",children:[e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-emerald-400"}),"Informações do Local"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>x(!t),className:"border-emerald-700/50 text-emerald-300 hover:bg-emerald-800/30",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Editar"]})]}),e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Nome do Local"}),e.jsx("p",{className:"text-emerald-50 font-medium mt-1",children:s.nomeDoLocal||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Endereço"}),e.jsxs("p",{className:"text-emerald-50 font-medium mt-1 flex items-start gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-emerald-400 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[s.endereco,", ",s.numero,s.complemento&&` - ${s.complemento}`,e.jsx("br",{}),s.cidade,"/",s.estado," - CEP: ",(e=>{if(!e)return"-";const a=e.replace(/\D/g,"");return 8!==a.length?e:a.replace(/(\d{5})(\d{3})/,"$1-$2")})(s.cep)]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Coordenadas"}),e.jsxs("p",{className:"text-emerald-50 font-medium mt-1",children:[s.latitude?.toFixed(6),", ",s.longitude?.toFixed(6)]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Tipo de Negócio"}),e.jsx("p",{className:"text-emerald-50 font-medium mt-1 capitalize",children:s.tipoDeNegocio?.replace(/_/g," ")||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Tipo de Acesso"}),e.jsx("p",{className:"text-emerald-50 font-medium mt-1 capitalize",children:s.tipoDeLocal||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Carregadores"}),e.jsxs("p",{className:"text-emerald-50 font-medium mt-1",children:[s.chargePoints?.length||0," carregadores"]})]})]})]})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-emerald-400"}),"Informações da Empresa"]})}),e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Razão Social"}),e.jsx("p",{className:"text-emerald-50 font-medium mt-1",children:s.razaoSocial||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"CNPJ"}),e.jsx("p",{className:"text-emerald-50 font-medium mt-1",children:(e=>{if(!e)return"-";const a=e.replace(/\D/g,"");return 14!==a.length?e:a.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5")})(s.cnpj)})]})]})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-emerald-400"}),"Responsável"]})}),e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Nome"}),e.jsxs("p",{className:"text-emerald-50 font-medium mt-1 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-emerald-400"}),s.nomeResponsavel||"-"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"E-mail"}),e.jsxs("p",{className:"text-emerald-50 font-medium mt-1 flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-emerald-400"}),s.emailResponsavel||"-"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-emerald-400/70 uppercase tracking-wider",children:"Telefone"}),e.jsxs("p",{className:"text-emerald-50 font-medium mt-1 flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-emerald-400"}),(e=>{if(!e)return"-";const a=e.replace(/\D/g,"");return 11===a.length?a.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):10===a.length?a.replace(/(\d{2})(\d{4})(\d{4})/,"($1) $2-$3"):e})(s.telefoneResponsavel)]})]})]})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center gap-2",children:[e.jsx(o,{className:"w-5 h-5 text-emerald-400"}),"Horário de Funcionamento"]})}),e.jsx(n,{className:"pt-6",children:(()=>{const a=s.horarioFuncionamento;return a?e.jsx("div",{className:"space-y-2",children:Y.map(s=>{const r=a[s];if(!r)return null;let t="";return t="24h"===r.tipo?"24 horas":"fechado"===r.tipo?"Fechado":"customizado"===r.tipo||r.abre_as?`${r.abre_as||"00:00"} - ${r.fecha_as||"00:00"}`:"Não informado",e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-emerald-300/70",children:Z[s]}),e.jsx("span",{className:"font-medium "+("fechado"===r.tipo?"text-red-400":"text-emerald-50"),children:t})]},s)})}):e.jsx("p",{className:"text-emerald-300/70",children:"Não informado"})})()})]})]})}function ee({locationId:s}){const[r,t]=a.useState([]),[m,b]=a.useState(!0),[f,N]=a.useState(1),[v,y]=a.useState(1),[w,k]=a.useState(0),[C,_]=a.useState(""),[E,z]=a.useState(""),D=a.useCallback(async()=>{b(!0);try{const e=new URLSearchParams({page:f.toString(),limit:"15"});E&&e.append("status",E);const a=await x.get(`/locations/${s}/transactions?${e}`);t(a.data.transactions||[]),y(a.data.totalPages||1),k(a.data.total||0)}catch(e){h.error("Erro ao carregar transações")}finally{b(!1)}},[s,f,E]);a.useEffect(()=>{D()},[D]);const T=e=>{if(!e)return"-";return new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},L=(e,a)=>{if(!e||!a)return"-";const s=new Date(e),r=new Date(a).getTime()-s.getTime(),t=Math.floor(r/6e4),l=Math.floor(t/60),d=t%60;return l>0?`${l}h ${d}min`:`${d}min`},P=a=>{const s=a.toLowerCase();return"completed"===s?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-emerald-500/20 text-emerald-400",children:"Concluída"}):"active"===s?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-500/20 text-blue-400",children:"Em andamento"}):"failed"===s?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-500/20 text-red-400",children:"Falhou"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-gray-500/20 text-gray-400",children:a})},A=C?r.filter(e=>e.chargePointId.toLowerCase().includes(C.toLowerCase())||e.idTag?.toLowerCase().includes(C.toLowerCase())):r;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-emerald-400/50"}),e.jsx(p,{placeholder:"Buscar por carregador ou usuário...",value:C,onChange:e=>_(e.target.value),className:"pl-10 bg-emerald-950/30 border-emerald-700/50 text-emerald-50"})]}),e.jsxs("select",{value:E,onChange:e=>{z(e.target.value),N(1)},className:"h-10 px-3 rounded-md bg-emerald-950/30 border border-emerald-700/50 text-emerald-50 text-sm",children:[e.jsx("option",{value:"",children:"Todos os status"}),e.jsx("option",{value:"Completed",children:"Concluídas"}),e.jsx("option",{value:"Active",children:"Em andamento"}),e.jsx("option",{value:"Failed",children:"Falhas"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:D,disabled:m,className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(j,{className:"w-4 h-4 mr-2 "+(m?"animate-spin":"")}),"Atualizar"]})]})})}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-emerald-400"}),"Transações"]}),e.jsxs("span",{className:"text-sm font-normal text-emerald-300/70",children:[w," transações encontradas"]})]})}),e.jsxs(n,{className:"p-0",children:[m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"w-6 h-6 text-emerald-500 animate-spin"})}):0===A.length?e.jsx("div",{className:"text-center py-12 text-emerald-300/70",children:"Nenhuma transação encontrada"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-emerald-800/30",children:[e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Carregador"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Início"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Duração"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Energia"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{children:A.map(a=>e.jsxs("tr",{className:"border-b border-emerald-800/20 hover:bg-emerald-800/10",children:[e.jsxs("td",{className:"py-3 px-4 text-emerald-50 font-mono text-sm",children:["#",a.transactionId||a.id]}),e.jsx("td",{className:"py-3 px-4 text-emerald-50 text-sm",children:a.chargePointId}),e.jsx("td",{className:"py-3 px-4 text-emerald-300/70 text-sm",children:T(a.startTimestamp)}),e.jsxs("td",{className:"py-3 px-4 text-emerald-300/70 text-sm flex items-center gap-1",children:[e.jsx(o,{className:"w-3 h-3"}),L(a.startTimestamp,a.stopTimestamp)]}),e.jsxs("td",{className:"py-3 px-4 text-amber-400 text-sm flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),((a.consumedWh||0)/1e3).toFixed(2)," kWh"]}),e.jsxs("td",{className:"py-3 px-4 text-emerald-400 text-sm flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),"R$ ",(a.totalCost||0).toFixed(2)]}),e.jsx("td",{className:"py-3 px-4",children:P(a.status)})]},a.id))})]})}),v>1&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-emerald-800/30",children:[e.jsxs("p",{className:"text-sm text-emerald-300/70",children:["Página ",f," de ",v]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>N(e=>Math.max(1,e-1)),disabled:1===f||m,className:"border-emerald-700/50 text-emerald-300",children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>N(e=>Math.min(v,e+1)),disabled:f===v||m,className:"border-emerald-700/50 text-emerald-300",children:e.jsx(R,{className:"w-4 h-4"})})]})]})]})]})]})}const ae=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.AreaChart}))),se=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.BarChart}))),re=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.LineChart}))),te=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.Area}))),le=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.Bar}))),de=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.Line}))),ie=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.XAxis}))),ce=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.YAxis}))),ne=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.CartesianGrid}))),me=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.Tooltip}))),oe=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.ResponsiveContainer}))),xe={occupancy:{label:"Taxa de Ocupação",unit:"%",color:"#10b981"},utilization:{label:"Utilização (kWh)",unit:"kWh",color:"#fbbf24"},availability:{label:"Disponibilidade",unit:"%",color:"#3b82f6"}};function he({locationId:s}){const[r,t]=a.useState(null),[m,p]=a.useState(!0),[g,f]=a.useState("30d"),[N,v]=a.useState("area"),[y,w]=a.useState("occupancy"),k=a.useCallback(async()=>{p(!0);try{const e=await x.get(`/locations/${s}/performance?period=${g}`);t(e.data)}catch(e){h.error("Erro ao carregar dados de performance")}finally{p(!1)}},[s,g]);a.useEffect(()=>{k()},[k]);const _=r?.dates.map((e,a)=>({date:e,occupancy:r.occupancyRate[a],utilization:r.utilization[a],availability:r.availability[a]}))||[],E=e=>{if(!r)return;const a=_.map(e=>({Data:e.date,"Taxa de Ocupação (%)":e.occupancy,"Utilização (kWh)":e.utilization,"Disponibilidade (%)":e.availability})),t={filename:`performance_local_${s}_${g}`,title:`Relatório de Performance - Local ${s}`,columns:[{key:"Data",header:"Data"},{key:"Taxa de Ocupação (%)",header:"Taxa de Ocupação (%)",format:"number"},{key:"Utilização (kWh)",header:"Utilização (kWh)",format:"number"},{key:"Disponibilidade (%)",header:"Disponibilidade (%)",format:"number"}],data:a};switch(e){case"csv":L(t),h.success("Relatório CSV exportado");break;case"excel":T(t),h.success("Relatório Excel exportado");break;case"pdf":D(t),h.success("Relatório PDF gerado")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-500/20 rounded-lg",children:e.jsx(P,{className:"w-5 h-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Taxa Ocupação"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:[r?.totals.avgOccupancy||0,"%"]})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-500/20 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Energia Total"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:[r?.totals.totalEnergy.toFixed(1)||0," kWh"]})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(o,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Disponibilidade"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:[r?.totals.avgAvailability||0,"%"]})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Sessões"}),e.jsx("p",{className:"text-xl font-bold text-emerald-50",children:r?.totals.totalSessions||0})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:e.jsx(b,{className:"w-5 h-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Média Diária"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:[r?.totals.avgUtilization.toFixed(1)||0," kWh"]})]})]})})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-emerald-400"}),"Performance"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"flex rounded-lg bg-emerald-950/50 p-1",children:Object.keys(xe).map(a=>e.jsx("button",{onClick:()=>w(a),className:"px-3 py-1.5 text-xs font-medium rounded-md transition-all "+(y===a?"bg-emerald-500/20 text-emerald-400":"text-emerald-300/70 hover:text-emerald-300"),children:xe[a].label.split(" ")[0]},a))}),e.jsx("div",{className:"flex rounded-lg bg-emerald-950/50 p-1",children:["7d","30d","90d"].map(a=>e.jsx("button",{onClick:()=>f(a),className:"px-3 py-1.5 text-xs font-medium rounded-md transition-all "+(g===a?"bg-emerald-500/20 text-emerald-400":"text-emerald-300/70 hover:text-emerald-300"),children:"7d"===a?"7 dias":"30d"===a?"30 dias":"90 dias"},a))}),e.jsx("div",{className:"flex rounded-lg bg-emerald-950/50 p-1",children:["area","bar","line"].map(a=>e.jsx("button",{onClick:()=>v(a),className:"px-2 py-1.5 text-xs font-medium rounded-md transition-all "+(N===a?"bg-emerald-500/20 text-emerald-400":"text-emerald-300/70 hover:text-emerald-300"),children:"area"===a?"Área":"bar"===a?"Barras":"Linha"},a))}),e.jsx(c,{variant:"ghost",size:"sm",onClick:k,disabled:m,className:"text-emerald-300 hover:bg-emerald-800/30",children:e.jsx(j,{className:"w-4 h-4 "+(m?"animate-spin":"")})})]})]})}),e.jsx(n,{className:"pt-6",children:m?e.jsx("div",{className:"h-[400px] flex items-center justify-center",children:e.jsx(j,{className:"w-8 h-8 text-emerald-500 animate-spin"})}):e.jsx("div",{className:"h-[400px]",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(j,{className:"w-6 h-6 text-emerald-500 animate-spin"})}),children:e.jsx(oe,{width:"100%",height:"100%",children:(()=>{const a=xe[y],s="occupancy"===y?"occupancy":"utilization"===y?"utilization":"availability",r={data:_,margin:{top:10,right:30,left:0,bottom:0}},t=e.jsxs(e.Fragment,{children:[e.jsx(ne,{strokeDasharray:"3 3",stroke:"#27272a"}),e.jsx(ie,{dataKey:"date",stroke:"#71717a",fontSize:12}),e.jsx(ce,{stroke:"#71717a",fontSize:12}),e.jsx(me,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",color:"#fafafa"}})]});switch(N){case"bar":return e.jsxs(se,{...r,children:[t,e.jsx(le,{dataKey:s,fill:a.color,radius:[4,4,0,0],maxBarSize:50})]});case"line":return e.jsxs(re,{...r,children:[t,e.jsx(de,{type:"monotone",dataKey:s,stroke:a.color,strokeWidth:3,dot:{r:4}})]});default:return e.jsxs(ae,{...r,children:[t,e.jsx("defs",{children:e.jsxs("linearGradient",{id:`gradient-${y}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:a.color,stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:a.color,stopOpacity:0})]})}),e.jsx(te,{type:"monotone",dataKey:s,stroke:a.color,strokeWidth:2,fill:`url(#gradient-${y})`})]})}})()})})})})]}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-emerald-50 font-medium",children:"Exportar Relatório"}),e.jsx("p",{className:"text-sm text-emerald-300/70",children:"Baixe os dados de performance em diferentes formatos"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>E("csv"),className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"CSV"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>E("excel"),className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Excel"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>E("pdf"),className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]})})})]})}const pe=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.AreaChart}))),je=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.Area}))),ue=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.XAxis}))),ge=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.YAxis}))),be=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.CartesianGrid}))),fe=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.Tooltip}))),Ne=a.lazy(()=>f(()=>import("./charts-BaPK5s1M.js").then(e=>e.i),__vite__mapDeps([0,1])).then(e=>({default:e.ResponsiveContainer})));function ve({locationId:s}){const[r,t]=a.useState(null),[m,o]=a.useState(!0),[p,b]=a.useState("30d"),f=a.useCallback(async()=>{o(!0);try{const e=await x.get(`/locations/${s}/financial?period=${p}`);t(e.data)}catch(e){h.error("Erro ao carregar dados financeiros")}finally{o(!1)}},[s,p]);a.useEffect(()=>{f()},[f]);const N=e=>{if(!r)return;const a=r.revenueByCharger.map(e=>({Carregador:e.chargerName||e.chargerId,"Sessões":e.sessions,"Energia (kWh)":(e.energy/1e3).toFixed(2),"Receita (R$)":e.revenue.toFixed(2)})),t={filename:`financeiro_local_${s}_${p}`,title:`Relatório Financeiro - Local ${s}`,columns:[{key:"Carregador",header:"Carregador"},{key:"Sessões",header:"Sessões",format:"number"},{key:"Energia (kWh)",header:"Energia (kWh)",format:"number"},{key:"Receita (R$)",header:"Receita (R$)",format:"currency"}],data:a};switch(e){case"csv":L(t),h.success("Relatório CSV exportado");break;case"excel":T(t),h.success("Relatório Excel exportado");break;case"pdf":D(t),h.success("Relatório PDF gerado")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-500/20 rounded-lg",children:e.jsx(g,{className:"w-5 h-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Receita Total"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:["R$ ",(r?.totalRevenue||0).toFixed(2)]})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-500/20 rounded-lg",children:e.jsx(P,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Média Diária"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:["R$ ",(r?.averageDailyRevenue||0).toFixed(2)]})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Sessões"}),e.jsx("p",{className:"text-xl font-bold text-emerald-50",children:r?.totalSessions||0})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Energia Total"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:[((r?.totalEnergy||0)/1e3).toFixed(1)," kWh"]})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:e.jsx(g,{className:"w-5 h-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Preço/kWh"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-50",children:["R$ ",(r?.pricePerKwh||0).toFixed(2)]})]})]})})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-emerald-400"}),"Receita ao Longo do Tempo"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex rounded-lg bg-emerald-950/50 p-1",children:["7d","30d","90d"].map(a=>e.jsx("button",{onClick:()=>b(a),className:"px-3 py-1.5 text-xs font-medium rounded-md transition-all "+(p===a?"bg-emerald-500/20 text-emerald-400":"text-emerald-300/70 hover:text-emerald-300"),children:"7d"===a?"7 dias":"30d"===a?"30 dias":"90 dias"},a))}),e.jsx(c,{variant:"ghost",size:"sm",onClick:f,disabled:m,className:"text-emerald-300 hover:bg-emerald-800/30",children:e.jsx(j,{className:"w-4 h-4 "+(m?"animate-spin":"")})})]})]})}),e.jsx(n,{className:"pt-6",children:m?e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsx(j,{className:"w-8 h-8 text-emerald-500 animate-spin"})}):e.jsx("div",{className:"h-[300px]",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(j,{className:"w-6 h-6 text-emerald-500 animate-spin"})}),children:e.jsx(Ne,{width:"100%",height:"100%",children:e.jsxs(pe,{data:r?.revenueChart||[],margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#27272a"}),e.jsx(ue,{dataKey:"date",stroke:"#71717a",fontSize:12}),e.jsx(ge,{stroke:"#71717a",fontSize:12}),e.jsx(fe,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px",color:"#fafafa"},formatter:e=>[`R$ ${e.toFixed(2)}`,"Receita"]}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"revenueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})}),e.jsx(je,{type:"monotone",dataKey:"revenue",stroke:"#10b981",strokeWidth:2,fill:"url(#revenueGradient)"})]})})})})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-emerald-400"}),"Receita por Carregador"]}),e.jsxs("span",{className:"text-sm font-normal text-emerald-300/70",children:[r?.revenueByCharger?.length||0," carregadores"]})]})}),e.jsx(n,{className:"p-0",children:m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"w-6 h-6 text-emerald-500 animate-spin"})}):r?.revenueByCharger?.length?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-emerald-800/30",children:[e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Carregador"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Sessões"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Energia"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs text-emerald-400/70 uppercase tracking-wider",children:"Receita"})]})}),e.jsx("tbody",{children:r.revenueByCharger.map(a=>e.jsxs("tr",{className:"border-b border-emerald-800/20 hover:bg-emerald-800/10",children:[e.jsx("td",{className:"py-3 px-4 text-emerald-50 font-medium",children:a.chargerName||a.chargerId}),e.jsx("td",{className:"py-3 px-4 text-emerald-300/70",children:a.sessions}),e.jsxs("td",{className:"py-3 px-4 text-amber-400 flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),(a.energy/1e3).toFixed(2)," kWh"]}),e.jsxs("td",{className:"py-3 px-4 text-emerald-400 font-medium",children:["R$ ",a.revenue.toFixed(2)]})]},a.chargerId))})]})}):e.jsx("div",{className:"text-center py-12 text-emerald-300/70",children:"Nenhum carregador encontrado"})})]}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-emerald-50 font-medium",children:"Exportar Relatório Financeiro"}),e.jsx("p",{className:"text-sm text-emerald-300/70",children:"Baixe os dados financeiros em diferentes formatos"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>N("csv"),className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"CSV"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>N("excel"),className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Excel"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>N("pdf"),className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]})})})]})}function ye({locationId:s}){const[r,t]=a.useState([]),[m,p]=a.useState(!0),[g,b]=a.useState(!0),f=a.useCallback(async()=>{try{const e=await x.get(`/locations/${s}/chargers`);t(e.data||[])}catch(e){h.error("Erro ao carregar status dos carregadores")}finally{p(!1)}},[s]);a.useEffect(()=>{f()},[f]),a.useEffect(()=>{if(!g)return;const e=setInterval(()=>{f()},3e4);return()=>clearInterval(e)},[g,f]);const N=e=>{if(!e)return"Nunca";const a=new Date(e),s=(new Date).getTime()-a.getTime(),r=Math.floor(s/6e4);if(r<1)return"Agora";if(r<60)return`${r}min atrás`;const t=Math.floor(r/60);if(t<24)return`${t}h atrás`;return`${Math.floor(t/24)}d atrás`},v=e=>{if(!e)return"-";const a=new Date(e),s=(new Date).getTime()-a.getTime(),r=Math.floor(s/6e4),t=Math.floor(r/60),l=r%60;return t>0?`${t}h ${l}min`:`${l}min`},y={online:r.filter(e=>["available","online","charging","occupied","preparing"].includes(e.status?.toLowerCase()||"")).length,offline:r.filter(e=>["unavailable","offline"].includes(e.status?.toLowerCase()||"")).length,charging:r.filter(e=>["charging","occupied"].includes(e.status?.toLowerCase()||"")).length,faulted:r.filter(e=>"faulted"===e.status?.toLowerCase()).length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-500/20 rounded-lg",children:e.jsx(A,{className:"w-5 h-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Online"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-50",children:y.online})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Carregando"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-50",children:y.charging})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-500/20 rounded-lg",children:e.jsx(F,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Offline"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-50",children:y.offline})]})]})})}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(O,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-300/60 uppercase",children:"Com Falha"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-50",children:y.faulted})]})]})})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-emerald-400"}),"Carregadores (",r.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-emerald-300/70 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:e=>b(e.target.checked),className:"rounded border-emerald-700 bg-emerald-950/50 text-emerald-500 focus:ring-emerald-500"}),"Auto-atualizar"]}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>{p(!0),f()},disabled:m,className:"text-emerald-300 hover:bg-emerald-800/30",children:[e.jsx(j,{className:"w-4 h-4 mr-2 "+(m?"animate-spin":"")}),"Atualizar"]})]})]})}),e.jsx(n,{className:"p-4",children:m&&0===r.length?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"w-6 h-6 text-emerald-500 animate-spin"})}):0===r.length?e.jsx("div",{className:"text-center py-12 text-emerald-300/70",children:"Nenhum carregador encontrado neste local"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(a=>{const s=(e=>{const a=e?.toLowerCase()||"";return"available"===a||"online"===a?{icon:V,color:"text-emerald-400",bg:"bg-emerald-500/20",label:"Disponível",badgeClass:"bg-emerald-500/20 text-emerald-400"}:"charging"===a||"occupied"===a?{icon:u,color:"text-blue-400",bg:"bg-blue-500/20",label:"Carregando",badgeClass:"bg-blue-500/20 text-blue-400"}:"preparing"===a?{icon:W,color:"text-amber-400",bg:"bg-amber-500/20",label:"Preparando",badgeClass:"bg-amber-500/20 text-amber-400"}:"finishing"===a||"suspendedev"===a||"suspendedevse"===a?{icon:M,color:"text-amber-400",bg:"bg-amber-500/20",label:"Finalizando",badgeClass:"bg-amber-500/20 text-amber-400"}:"faulted"===a?{icon:O,color:"text-red-400",bg:"bg-red-500/20",label:"Com Falha",badgeClass:"bg-red-500/20 text-red-400"}:"unavailable"===a||"offline"===a?{icon:F,color:"text-gray-400",bg:"bg-gray-500/20",label:"Indisponível",badgeClass:"bg-gray-500/20 text-gray-400"}:{icon:M,color:"text-gray-400",bg:"bg-gray-500/20",label:e||"Desconhecido",badgeClass:"bg-gray-500/20 text-gray-400"}})(a.connectorStatus||a.status),r=s.icon;return e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/60 to-emerald-900/30 border-emerald-800/40 transition-all hover:border-emerald-700/50",children:e.jsxs(n,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 ${s.bg} rounded-lg`,children:e.jsx(r,{className:`w-5 h-5 ${s.color}`})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-emerald-50 font-medium",children:a.name||a.chargePointId}),e.jsx("p",{className:"text-xs text-emerald-300/50 font-mono",children:a.chargePointId})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.badgeClass}`,children:s.label})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-emerald-300/70 flex items-center gap-1",children:[e.jsx(o,{className:"w-3 h-3"}),"Último heartbeat"]}),e.jsx("span",{className:"text-emerald-50",children:N(a.lastHeartbeat)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-emerald-300/70 flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),"Uptime"]}),e.jsx("span",{className:"text-emerald-50",children:(t=a.uptime,!t||t<0?"-":`${t.toFixed(1)}%`)})]}),a.currentTransaction&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-t border-emerald-800/30 pt-2 mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-blue-400 flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),"Carregando"]}),e.jsx("span",{className:"text-blue-300",children:v(a.currentTransaction.startTime)})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("span",{className:"text-emerald-300/70",children:"Energia"}),e.jsxs("span",{className:"text-amber-400",children:[((a.currentTransaction.meterValue||0)/1e3).toFixed(2)," kWh"]})]})]})})]})]})},a.id);var t})})})]})]})}const we={info:"Informações",transactions:"Transações",performance:"Performance",financial:"Financeiro",monitoring:"Monitoramento"};function ke({locationId:s}){const[r,t]=a.useState([]),[m,o]=a.useState(!0),[u,g]=a.useState(null),[b,f]=a.useState(""),[w,k]=a.useState(!1),[C,_]=a.useState([]),[z,$]=a.useState(null),[I,R]=a.useState({transactions:!1,performance:!1,financial:!1,monitoring:!1,info:!0}),D=a.useCallback(async()=>{o(!0);try{const e=await x.get(`/locations/${s}/users`);t(e.data||[])}catch(e){h.error("Erro ao carregar permissões")}finally{o(!1)}},[s]),T=a.useCallback(async()=>{try{const e=await x.get("/users"),a=r.map(e=>e.userId),s=(e.data||[]).filter(e=>!a.includes(e.id));_(s)}catch(e){}},[r]);a.useEffect(()=>{D()},[D]),a.useEffect(()=>{w&&T()},[w,T]);const L=b?r.filter(e=>e.userName.toLowerCase().includes(b.toLowerCase())||e.userEmail.toLowerCase().includes(b.toLowerCase())):r;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-md",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-emerald-400/50"}),e.jsx(p,{placeholder:"Buscar usuário...",value:b,onChange:e=>f(e.target.value),className:"pl-10 bg-emerald-950/30 border-emerald-700/50 text-emerald-50"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:D,disabled:m,className:"border-emerald-700/50 text-emerald-300",children:[e.jsx(j,{className:"w-4 h-4 mr-2 "+(m?"animate-spin":"")}),"Atualizar"]}),e.jsxs(c,{size:"sm",onClick:()=>k(!0),className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Adicionar Usuário"]})]})]})})}),w&&e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/60 to-emerald-900/40 border-emerald-600/50",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-emerald-400"}),"Adicionar Novo Usuário"]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>k(!1),className:"text-emerald-300 hover:bg-emerald-800/30",children:e.jsx(B,{className:"w-4 h-4"})})]})}),e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-emerald-300/70 mb-2 block",children:"Selecione o usuário"}),e.jsxs("select",{value:z||"",onChange:e=>$(Number(e.target.value)||null),className:"w-full h-10 px-3 rounded-md bg-emerald-950/30 border border-emerald-700/50 text-emerald-50 text-sm",children:[e.jsx("option",{value:"",children:"Selecione..."}),C.map(a=>e.jsxs("option",{value:a.id,children:[a.nome," (",a.email,")"]},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-emerald-300/70 mb-3 block",children:"Permissões"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:Object.keys(we).map(a=>e.jsxs("label",{className:`\n                          flex items-center gap-2 p-3 rounded-lg cursor-pointer transition-all\n                          ${I[a]?"bg-emerald-500/20 border border-emerald-500/50":"bg-emerald-950/30 border border-emerald-800/30 hover:border-emerald-700/50"}\n                        `,children:[e.jsx("input",{type:"checkbox",checked:I[a],onChange:()=>R(e=>({...e,[a]:!e[a]})),className:"hidden"}),e.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center "+(I[a]?"bg-emerald-500 text-white":"bg-emerald-950/50 border border-emerald-700/50"),children:I[a]&&e.jsx(N,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm text-emerald-50",children:we[a]})]},a))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>k(!1),className:"border-emerald-700/50 text-emerald-300",children:"Cancelar"}),e.jsxs(c,{onClick:async()=>{if(z){g(-1);try{await x.post(`/locations/${s}/users`,{userId:z,permissions:I}),h.success("Usuário adicionado com sucesso"),k(!1),$(null),R({transactions:!1,performance:!1,financial:!1,monitoring:!1,info:!0}),D()}catch(e){h.error(e.response?.data?.message||"Erro ao adicionar usuário")}finally{g(null)}}else h.error("Selecione um usuário")},disabled:!z||-1===u,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:[-1===u?e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(E,{className:"w-4 h-4 mr-2"}),"Adicionar"]})]})]})})]}),e.jsxs(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:[e.jsx(d,{className:"border-b border-emerald-800/30 pb-4",children:e.jsxs(i,{className:"text-lg text-emerald-50 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-emerald-400"}),"Usuários com Acesso"]}),e.jsxs("span",{className:"text-sm font-normal text-emerald-300/70",children:[r.length," usuário(s)"]})]})}),e.jsx(n,{className:"p-0",children:m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"w-6 h-6 text-emerald-500 animate-spin"})}):0===L.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"w-12 h-12 text-emerald-500/30 mx-auto mb-3"}),e.jsx("p",{className:"text-emerald-300/70",children:b?"Nenhum usuário encontrado":"Nenhum usuário tem acesso a este local"}),!b&&e.jsxs(c,{size:"sm",onClick:()=>k(!0),className:"mt-4 bg-emerald-600 hover:bg-emerald-700 text-white",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Adicionar Primeiro Usuário"]})]}):e.jsx("div",{className:"divide-y divide-emerald-800/30",children:L.map(a=>e.jsxs("div",{className:"p-4 hover:bg-emerald-800/10 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center",children:e.jsx("span",{className:"text-emerald-400 font-medium",children:a.userName?.charAt(0)?.toUpperCase()||"U"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-emerald-50 font-medium",children:a.userName}),e.jsx("p",{className:"text-sm text-emerald-300/70",children:a.userEmail})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>(async(e,a)=>{if(confirm(`Remover acesso de "${a}" a este local?`)){g(e);try{await x.delete(`/locations/${s}/users/${e}`),t(a=>a.filter(a=>a.userId!==e)),h.success("Usuário removido")}catch(r){h.error("Erro ao remover usuário")}finally{g(null)}}})(a.userId,a.userName),disabled:u===a.userId,className:"text-red-400 hover:text-red-300 hover:bg-red-500/10",children:e.jsx(y,{className:"w-4 h-4"})})})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:Object.keys(we).map(l=>e.jsxs("button",{onClick:()=>(async(e,a)=>{const l=r.find(a=>a.userId===e);if(!l)return;const d={...l.permissions,[a]:!l.permissions[a]};g(e);try{await x.put(`/locations/${s}/users/${e}`,{permissions:d}),t(a=>a.map(a=>a.userId===e?{...a,permissions:d}:a)),h.success("Permissão atualizada")}catch(i){h.error("Erro ao atualizar permissão")}finally{g(null)}})(a.userId,l),disabled:u===a.userId,className:`\n                            flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium transition-all\n                            ${a.permissions[l]?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-emerald-950/30 text-emerald-300/50 border border-emerald-800/30 hover:border-emerald-700/50"}\n                            ${u===a.userId?"opacity-50 cursor-not-allowed":""}\n                          `,children:[a.permissions[l]&&e.jsx(N,{className:"w-3 h-3"}),we[l]]},l))})]},a.userId))})})]})]})}const Ce=[{id:"info",label:"Informações",icon:U,permissionKey:"info"},{id:"transactions",label:"Transações",icon:$,permissionKey:"transactions"},{id:"performance",label:"Performance",icon:H,permissionKey:"performance"},{id:"financial",label:"Financeiro",icon:g,permissionKey:"financial"},{id:"monitoring",label:"Monitoramento",icon:m,permissionKey:"monitoring"},{id:"permissions",label:"Permissões",icon:v,permissionKey:"permissions"}];function _e(){const{id:t}=s(),d=r(),[i,o]=a.useState(null),[p,u]=a.useState(null),[g,b]=a.useState("info"),[f,N]=a.useState(!0),[y,w]=a.useState(!1),k=a.useCallback(async()=>{if(t)try{const[e,a]=await Promise.all([x.get(`/locations/${t}`),x.get(`/locations/${t}/my-permissions`)]);if(o(e.data),u(a.data),!a.data.info){const e=Ce.find(e=>a.data[e.permissionKey]);e&&b(e.id)}}catch(e){h.error("Erro ao carregar dados do local"),404===e.status&&d("/locais")}finally{N(!1)}},[t,d]);a.useEffect(()=>{k()},[k]);const C=p?Ce.filter(e=>p[e.permissionKey]):[];return f?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(j,{className:"w-8 h-8 text-emerald-500 animate-spin"}),e.jsx("p",{className:"text-emerald-300/70",children:"Carregando local..."})]})}):i?0===C.length?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30 p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-12 h-12 text-amber-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-emerald-50 mb-2",children:"Acesso Restrito"}),e.jsx("p",{className:"text-emerald-300/70 mb-4",children:"Você não tem permissão para visualizar este local."}),e.jsxs(c,{onClick:()=>d("/locais"),variant:"outline",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Voltar para Locais"]})]})})}):e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>d("/locais"),className:"text-emerald-300 hover:text-emerald-50 hover:bg-emerald-800/30",children:e.jsx(K,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-emerald-50",children:i.nomeDoLocal||"Local sem nome"}),e.jsxs("p",{className:"text-emerald-300/70 text-sm flex items-center gap-1",children:[e.jsx(m,{className:"w-3 h-3"}),i.endereco,", ",i.numero," - ",i.cidade,"/",i.estado]})]})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:async()=>{w(!0),await k(),w(!1),h.success("Dados atualizados")},disabled:y,className:"border-emerald-700/50 text-emerald-300 hover:bg-emerald-800/30",children:[e.jsx(j,{className:"w-4 h-4 mr-2 "+(y?"animate-spin":"")}),"Atualizar"]})]}),e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30",children:e.jsx(n,{className:"p-2",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:C.map(a=>{const s=a.icon,r=g===a.id;return e.jsxs("button",{onClick:()=>b(a.id),className:`\n                    flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium text-sm transition-all\n                    ${r?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"text-emerald-300/70 hover:text-emerald-300 hover:bg-emerald-800/20"}\n                  `,children:[e.jsx(s,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:a.label})]},a.id)})})})}),e.jsxs("div",{className:"min-h-[500px]",children:["info"===g&&p?.info&&e.jsx(J,{location:i,onUpdate:k}),"transactions"===g&&p?.transactions&&e.jsx(ee,{locationId:parseInt(t)}),"performance"===g&&p?.performance&&e.jsx(he,{locationId:parseInt(t)}),"financial"===g&&p?.financial&&e.jsx(ve,{locationId:parseInt(t)}),"monitoring"===g&&p?.monitoring&&e.jsx(ye,{locationId:parseInt(t)}),"permissions"===g&&p?.permissions&&e.jsx(ke,{locationId:parseInt(t)})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(l,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30 p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(q,{className:"w-12 h-12 text-emerald-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-emerald-50 mb-2",children:"Local não encontrado"}),e.jsx("p",{className:"text-emerald-300/70 mb-4",children:"O local solicitado não existe ou foi removido."}),e.jsxs(c,{onClick:()=>d("/locais"),variant:"outline",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Voltar para Locais"]})]})})})}export{_e as LocationDetails,_e as default};
