import{j as e}from"./ui-vendor-D6QdPKSZ.js";import{a as s}from"./react-vendor-BVAhLato.js";import{f as a,t,e as r,C as d,a as i,b as l,d as o,B as n}from"./index-BaJa-ZGP.js";import{E as c,a as m,b as h,c as x,d as j,e as p}from"./EnhancedTable-DB0V6gm6.js";import{S as u}from"./StatusBadge-BNii0mfw.js";import{E as b}from"./ExportButton-DGozts7C.js";import{C as f,a as g}from"./chevron-right-BDIPc-07.js";import"./charts-BaPK5s1M.js";import"./table-KAkNip0H.js";import"./badge-CIrDOdUW.js";import"./export-B3G8m_WB.js";import"./file-text-D9j_NDks.js";const _=[{key:"transaction_id",header:"ID",format:"number"},{key:"charge_point_id",header:"Carregador",format:"text"},{key:"start_timestamp",header:"Inicio",format:"date"},{key:"stop_timestamp",header:"Fim",format:"date"},{key:"consumed_kwh",header:"Energia (kWh)",format:"number"},{key:"total_cost",header:"Custo (R$)",format:"currency"},{key:"address",header:"Endereco",format:"text"},{key:"status",header:"Status",format:"text"}],N=()=>{const[N,w]=s.useState([]),[v,y]=s.useState(!0),[k,E]=s.useState(null),[S,C]=s.useState(1),F=N.map(e=>({transaction_id:e.transaction_id,charge_point_id:e.charge_point_id,start_timestamp:e.start_timestamp,stop_timestamp:e.stop_timestamp,consumed_kwh:null!=e.consumed_wh?e.consumed_wh/1e3:0,total_cost:null!=e.total_cost?parseFloat(e.total_cost.toString()):0,address:e.address||"N/A",status:e.status}));s.useEffect(()=>{z()},[]);const z=async()=>{y(!0),E(null);try{const e=await a.get("/transactions");if(!e.ok)throw new Error("Falha ao buscar os dados das transações.");const s=await e.json();w(s)}catch(e){const s=e instanceof Error?e.message:"Erro desconhecido";E(s),t.error(s)}finally{y(!1)}},T=Math.ceil(N.length/10),B=10*(S-1),I=B+10,R=N.slice(B,I),A=e=>e?new Date(e).toLocaleString("pt-BR"):"---",D=e=>{const s=e?.toLowerCase();return"completed"===s||"finalizado"===s?"completed":"failed"===s||"falhou"===s?"failed":"pending"};return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-zinc-400",children:"Carregando dados..."})}):k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-red-400",children:["Erro: ",k]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-emerald-50 flex items-center gap-3",children:[e.jsx(r,{className:"w-8 h-8 text-emerald-400"}),"Histórico de Transações"]}),e.jsx("p",{className:"text-emerald-300/60 mt-1",children:"Visualize todas as transações realizadas"})]}),e.jsxs(d,{className:"bg-gradient-to-br from-emerald-950/40 to-emerald-900/20 border-emerald-800/30 backdrop-blur-sm shadow-2xl shadow-emerald-900/20",children:[e.jsx(i,{className:"border-b border-emerald-800/30 pb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(l,{className:"text-emerald-50 flex items-center gap-2",children:[e.jsx(r,{className:"w-5 h-5 text-emerald-400"}),"Transacoes"]}),e.jsxs("p",{className:"text-sm text-emerald-300/60 mt-1",children:["Total de ",N.length," transacoes"]})]}),e.jsx(b,{data:F,columns:_,filename:"transacoes_neopower",title:"Historico de Transacoes - NeoPower",disabled:0===N.length})]})}),e.jsxs(o,{className:"pt-6",children:[e.jsxs(c,{striped:!0,hoverable:!0,children:[e.jsx(m,{children:e.jsxs(h,{hoverable:!1,children:[e.jsx(x,{children:"ID"}),e.jsx(x,{children:"Carregador"}),e.jsx(x,{children:"Início"}),e.jsx(x,{children:"Fim"}),e.jsx(x,{children:"Energia (kWh)"}),e.jsx(x,{children:"Custo (R$)"}),e.jsx(x,{children:"Endereço"}),e.jsx(x,{children:"Status"})]})}),e.jsx(j,{children:R.map((s,a)=>e.jsxs(h,{index:a,children:[e.jsx(p,{className:"font-mono",children:e.jsx("span",{className:"px-2 py-1 rounded bg-emerald-500/10 border border-emerald-500/20 text-emerald-300",children:s.transaction_id})}),e.jsx(p,{className:"font-medium",children:s.charge_point_id}),e.jsx(p,{className:"text-sm",children:A(s.start_timestamp)}),e.jsx(p,{className:"text-sm",children:A(s.stop_timestamp)}),e.jsx(p,{highlight:!0,children:null!=s.consumed_wh?(s.consumed_wh/1e3).toFixed(2):"0.00"}),e.jsxs(p,{highlight:!0,children:["R$"," ",null!=s.total_cost?parseFloat(s.total_cost.toString()).toFixed(2):"0.00"]}),e.jsx(p,{className:"text-sm text-emerald-300/70",children:s.address||"N/A"}),e.jsx(p,{children:e.jsx(u,{status:D(s.status||"pending")})})]},s.transaction_id))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-emerald-800/30",children:[e.jsxs("div",{className:"text-sm text-emerald-300/70",children:["Página ",S," de ",T," (",N.length," transações)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{C(e=>Math.max(1,e-1))},disabled:1===S,className:"bg-emerald-900/40 border-emerald-700/50 text-emerald-100 hover:bg-emerald-800/60 hover:border-emerald-600 disabled:opacity-30 disabled:cursor-not-allowed transition-all",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),"Anterior"]}),e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{C(e=>Math.min(T,e+1))},disabled:S===T||0===T,className:"bg-emerald-900/40 border-emerald-700/50 text-emerald-100 hover:bg-emerald-800/60 hover:border-emerald-600 disabled:opacity-30 disabled:cursor-not-allowed transition-all",children:["Próxima",e.jsx(g,{className:"w-4 h-4 ml-1"})]})]})]})]})]})]})};export{N as Transactions};
